<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Навигация — Лабораторная РПП</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;line-height:1.6;margin:2rem;}
    ul{padding-left:1.2rem}
    code{background:#f6f8fa;padding:.1rem .3rem;border-radius:.25rem}
    .card{border:1px solid #e5e7eb;border-radius:.75rem;padding:1rem;margin:1rem 0}
    .muted{opacity:.65}
    a{color:#2563eb;text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <h1>Лабораторная РПП: GitHub Pages + CI/CD</h1>
  <div class="card">
    <h2>Разделы сайта</h2>
    <ul>
      <li><a href="/rpp_4lab/ru/">Русская версия</a> — <code>/ru/</code></li>
      <li><a href="/rpp_4lab/en/">English version</a> — <code>/en/</code></li>
    </ul>
  </div>

  <div class="card">
    <h2>Версии (релизы)</h2>
    <p class="muted">После публикации релиза сайт будет доступен по адресу вида:<br>
    <code>https://<user>.github.io/<repo>/v<release>/</code></p>
    <p>Список релизов подгружается с GitHub API (клиент‑сайд):</p>
    <ul id="versions"></ul>
  </div>

  <script>
    const OWNER = location.hostname.split('.')[0];
    const REPO = location.pathname.split('/')[1] || '';

    async function loadReleases(){
      const url = `https://api.github.com/repos/${OWNER}/${REPO}/releases`;
      try{
        const res = await fetch(url);
        const data = await res.json();
        const list = document.getElementById('versions');
        list.innerHTML = '';
        (data||[]).forEach(r=>{
          const name = r.name && r.name.trim() ? r.name : r.tag_name;
          const vseg = name.startsWith('v') ? name : 'v'+name;
          const li = document.createElement('li');
          li.innerHTML = `<a href="./${REPO}/v${name.startsWith('v')?name.slice(1):name}/">${vseg}</a>`;
          list.appendChild(li);
        });
        if(!list.children.length){
          list.innerHTML = '<li class="muted">Релизов пока нет</li>';
        }
      }catch(e){
        document.getElementById('versions').innerHTML = '<li class="muted">Не удалось загрузить список релизов</li>';
      }
    }
    loadReleases();
  </script>
</body>
</html>
