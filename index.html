<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Навигация — Лабораторная РПП</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif; line-height: 1.6; margin: 2rem; }
    ul { padding-left: 1.2rem; }
    code { background:#f6f8fa; padding:.1rem .3rem; border-radius:.25rem; }
    .card { border:1px solid #e5e7eb; border-radius:.75rem; padding:1rem; margin:1rem 0; }
    .muted { opacity:.65; }
    a { color:#2563eb; text-decoration:none; }
    a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  <h1>Лабораторная РПП: GitHub Pages + CI/CD</h1>

  <div class="card">
    <h2>Разделы сайта</h2>
    <ul>
      <li><a href="/rpp_4lab/ru/">Русская версия</a> — <code>/ru/</code></li>
      <li><a href="/rpp_4lab/en/">English version</a> — <code>/en/</code></li>
    </ul>
  </div>

  <div class="card">
    <h2>Версии (релизы)</h2>
    <p class="muted">
      После публикации релиза сайт будет доступен по адресу вида:<br>
      <code>https://&lt;user&gt;.github.io/&lt;repo&gt;/v&lt;release&gt;/</code>
    </p>
    <p>Список релизов подгружается с GitHub API (клиент-сайд):</p>
    <ul id="versions"></ul>
  </div>

  <script>
  (async () => {
    const OWNER = 'Kisonya';
    const REPO  = 'rpp_4lab';
    const BASE  = '/' + REPO; // /rpp_4lab

    try {
      const res = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/releases`);
      const releases = await res.json();
      const list = document.getElementById('versions');
      list.innerHTML = '';

      if (!Array.isArray(releases) || releases.length === 0) {
        list.innerHTML = '<li class="muted">Релизов пока нет</li>';
        return;
      }

      for (const rel of releases) {
        let tag = (rel.tag_name || '').trim();
        if (!tag) continue;
        if (!tag.startsWith('v')) tag = 'v' + tag;

        const li = document.createElement('li');
        const a  = document.createElement('a');
        a.href = `${BASE}/${encodeURIComponent(tag)}/`; // абсолютная ссылка
        a.textContent = tag;

        li.appendChild(a);

        if (rel.name && rel.name !== tag) {
          const small = document.createElement('small');
          small.style.marginLeft = '8px';
          small.textContent = `— ${rel.name}`;
          li.appendChild(small);
        }
        list.appendChild(li);
      }
    } catch {
      document.getElementById('versions').innerHTML = '<li class="muted">Ошибка загрузки списка релизов</li>';
    }
  })();
  </script>
</body>
</html>
